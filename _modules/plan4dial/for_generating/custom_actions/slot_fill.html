
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>plan4dial.for_generating.custom_actions.slot_fill &#8212; Plan4Dial 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css" />
    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for plan4dial.for_generating.custom_actions.slot_fill</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Contains all the functions for the `slot_fill` custom action that is</span>
<span class="sd">provided to bot designers by default.</span>

<span class="sd">Authors:</span>
<span class="sd">- Rebecca De Venezia</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">map_assignment_update</span>
<span class="kn">from</span> <span class="nn">..parsers.json_config_parser</span> <span class="kn">import</span> <span class="n">configure_assignments</span>


<div class="viewcode-block" id="slot_fill"><a class="viewcode-back" href="../../../../generated/plan4dial.for_generating.custom_actions.slot_fill.html#plan4dial.for_generating.custom_actions.slot_fill.slot_fill">[docs]</a><span class="k">def</span> <span class="nf">slot_fill</span><span class="p">(</span>
    <span class="n">loaded_yaml</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="n">action_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">message_variants</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">entities</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">config_entities</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fallback_message_variants</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">additional_updates</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Custom action provided by default that allows bot designers to specify</span>
<span class="sd">    entity slot fills with ease.</span>

<span class="sd">    Handles actions that can be clarified, as well as those that can&#39;t, or a</span>
<span class="sd">    mix of both. This depends on what the `known`&#39;s `type` setting is for each</span>
<span class="sd">    entity in the YAML.</span>

<span class="sd">    Also handles &quot;partial&quot; extraction, where the bot asks for multiple entities</span>
<span class="sd">    but is only able to extract some. In that case, the bot will follow up with</span>
<span class="sd">    `clarify` actions in which it tries to extract uncertain entities, or `single_slot` actions in which it tries to extract unknown entities</span>
<span class="sd">    individually in order to make up for the missing information (only used</span>
<span class="sd">    when there are &gt; 1 entities specified).</span>

<span class="sd">    Additional outcomes can also be specified for certain outcomes, i.e. when</span>
<span class="sd">    entity `pizza` is extracted, respond with the given `response_variants`.</span>

<span class="sd">    Args:</span>
<span class="sd">        loaded_yaml (Dict): The loaded YAML configuration.</span>
<span class="sd">        action_name (str): The name of this instance of the custom action.</span>
<span class="sd">        message_variants (List[str]): Possible messages the bot will utter uponexecution of this action.</span>
<span class="sd">        entities (List[str]): The entities to be extracted or have their &quot;slots filled.&quot;</span>
<span class="sd">        config_entities (Dict): Holds configurations that specify what the botshould do in certain situations regarding each entity. The keys are each entity and the values are the configuration for each entity. Defaults to None as this is not always necessary.</span>

<span class="sd">    The 3 configuration options are:</span>
<span class="sd">        clarify_message_variants (List[str]): The message variants that will</span>
<span class="sd">        be used for the clarify action for this entity. Only necessary if the</span>
<span class="sd">        `known` `type` of this entity is of type `fflag`.</span>
<span class="sd">        single_slot_message_variants (List[str]): Custom message variants to</span>
<span class="sd">        utter for `single_slot` extractions of the given entity. Only necessary</span>
<span class="sd">        to specify if there are &gt; 1 entities.</span>
<span class="sd">        fallback_message_variants (List[str]): Custom fallback messages to</span>
<span class="sd">        utter if the bot tries to extract this entity by itself with a</span>
<span class="sd">        `single_slot` action and fails. Differs from the outer </span>
<span class="sd">        `fallback_message_variants` parameter, which applies to the initial</span>
<span class="sd">        `slot_fill` action only. The default fallback messages will replace </span>
<span class="sd">        this parameter if not specified.</span>

<span class="sd">    fallback_message_variants (List[str]): Custom fallback messages to utter</span>
<span class="sd">    if the bot fails to extract any entities. Defaults to None.</span>
<span class="sd">    additional_updates (Dict, optional): Additional updates to specify when</span>
<span class="sd">    a given extraction happens AT ANY POINT. Indicate the extraction that </span>
<span class="sd">    happens in the outcome by specifying the `known` status of the entities you</span>
<span class="sd">    desire. You can not only use this to add arbitrary context variable</span>
<span class="sd">    updates under `also_update`, but also other outcome-specific attributes</span>
<span class="sd">    such as `response_variants`. NOTE: Will only match to outcomes that match</span>
<span class="sd">    the given specification exactly. For example, if you specify an additional</span>
<span class="sd">    update for when `test1` is known, updates would only be added to actions</span>
<span class="sd">    where ONLY `test1` is extracted, and not when `test1`, `test2` and `test3`</span>
<span class="sd">    are extracted, for example. This is done to reduce ambiguity. </span>
<span class="sd">    Defaults to None.</span>

<span class="sd">    See the tutorial in `README.md` for an example of a `slot_fill` action.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">additional_updates</span><span class="p">:</span>
        <span class="c1"># iterate through all additional updates</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">additional_updates</span><span class="p">)):</span>
            <span class="c1"># iterate through each context variable detailed in the outcome</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">additional_updates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;outcome&quot;</span><span class="p">]:</span>
                <span class="c1"># convert to an assignment setting so we can more easily</span>
                <span class="c1"># identify what outcome we&#39;re referring to</span>
                <span class="n">additional_updates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;outcome&quot;</span><span class="p">][</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">configure_assignments</span><span class="p">(</span><span class="n">additional_updates</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;outcome&quot;</span><span class="p">][</span><span class="n">var</span><span class="p">][</span><span class="s2">&quot;known&quot;</span><span class="p">])</span>
        <span class="n">cfg_updates</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">setting</span> <span class="ow">in</span> <span class="n">additional_updates</span><span class="p">:</span>
            <span class="c1"># we don&#39;t want to consider when entities are NOT found because</span>
            <span class="c1"># 1) it&#39;s a lot more ambiguous and 2) when extracting entities, we</span>
            <span class="c1"># only have knowledge of what we DID extract and not what we</span>
            <span class="c1"># DIDN&#39;T. (yes, we could figure it out by looking at the available</span>
            <span class="c1"># outcome groups, but it&#39;s just more overhead for what seems like</span>
            <span class="c1"># an edge case - specifying additional updates when updates ARE</span>
            <span class="c1"># extracted is just a lot more intuitive).</span>

            <span class="c1"># frozenset is an easy way to see at a glance the assignment</span>
            <span class="c1"># setting of each (known/maybe known) context variable</span>
            <span class="n">key</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="n">entity</span><span class="p">:</span> <span class="n">certainty</span>
                    <span class="k">for</span> <span class="n">entity</span><span class="p">,</span> <span class="n">certainty</span> <span class="ow">in</span> <span class="n">setting</span><span class="p">[</span><span class="s2">&quot;outcome&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">certainty</span> <span class="o">!=</span> <span class="s2">&quot;didnt-find&quot;</span>
                <span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="c1"># add the appropriate updates</span>
            <span class="n">cfg_updates</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="s2">&quot;also_update&quot;</span> <span class="ow">in</span> <span class="n">setting</span><span class="p">:</span>
                <span class="n">cfg_updates</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;updates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">setting</span><span class="p">[</span><span class="s2">&quot;also_update&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;response_variants&quot;</span> <span class="ow">in</span> <span class="n">setting</span><span class="p">:</span>
                <span class="n">cfg_updates</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;response_variants&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">setting</span><span class="p">[</span><span class="s2">&quot;response_variants&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;follow_up&quot;</span> <span class="ow">in</span> <span class="n">setting</span><span class="p">:</span>
                <span class="n">cfg_updates</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;follow_up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">setting</span><span class="p">[</span><span class="s2">&quot;follow_up&quot;</span><span class="p">]</span>
    <span class="n">entity_combos</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># create the cross-product of found, maybe-found, and didnt-find with the entities given</span>
    <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">entities</span><span class="p">:</span>
        <span class="n">entity_combos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">p</span>
                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">entity</span><span class="p">],</span>
                    <span class="p">(</span>
                        <span class="p">[</span><span class="s2">&quot;found&quot;</span><span class="p">,</span> <span class="s2">&quot;maybe-found&quot;</span><span class="p">,</span> <span class="s2">&quot;didnt-find&quot;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">loaded_yaml</span><span class="p">[</span><span class="s2">&quot;context_variables&quot;</span><span class="p">][</span><span class="n">entity</span><span class="p">][</span><span class="s2">&quot;known&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>
                        <span class="o">==</span> <span class="s2">&quot;fflag&quot;</span>
                        <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;found&quot;</span><span class="p">,</span> <span class="s2">&quot;didnt-find&quot;</span><span class="p">]</span>
                    <span class="p">),</span>
                <span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="n">entity_combos</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">entity_combos</span><span class="p">)</span>
    <span class="c1"># instantiate the action</span>
    <span class="n">action</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">action</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="n">action</span><span class="p">[</span><span class="s2">&quot;subtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;dialogue&quot;</span><span class="p">,</span> <span class="s2">&quot;dialogue disambiguation&quot;</span>
    <span class="n">action</span><span class="p">[</span><span class="s2">&quot;message_variants&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">message_variants</span>
    <span class="k">if</span> <span class="n">fallback_message_variants</span><span class="p">:</span>
        <span class="n">action</span><span class="p">[</span><span class="s2">&quot;fallback_message_variants&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fallback_message_variants</span>
    <span class="c1"># condition: none of the entities can be found</span>
    <span class="n">action</span><span class="p">[</span><span class="s2">&quot;condition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">entities</span><span class="p">:</span>
        <span class="n">action</span><span class="p">[</span><span class="s2">&quot;condition&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">map_assignment_update</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="s2">&quot;didnt-find&quot;</span><span class="p">))</span>
    <span class="n">action</span><span class="p">[</span><span class="s2">&quot;effect&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;validate-slot-fill&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;oneof&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;outcomes&quot;</span><span class="p">:</span> <span class="p">{}}}}</span>
    <span class="c1"># iterate through all the possible entity combinations</span>
    <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="n">entity_combos</span><span class="p">:</span>
        <span class="c1"># refine combo by exluding &quot;didnt-find&quot; which we don&#39;t need for updates</span>
        <span class="n">refined_combo</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">entity</span><span class="p">:</span> <span class="n">certainty</span>
            <span class="k">for</span> <span class="n">entity</span><span class="p">,</span> <span class="n">certainty</span> <span class="ow">in</span> <span class="n">combo</span>
            <span class="k">if</span> <span class="n">certainty</span> <span class="o">!=</span> <span class="s2">&quot;didnt-find&quot;</span>
        <span class="p">}</span>
        <span class="c1"># only consider outcomes in which we find at elast something</span>
        <span class="k">if</span> <span class="n">refined_combo</span><span class="p">:</span>
            <span class="n">next_out</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;updates&quot;</span><span class="p">:</span> <span class="p">{}}</span>
            <span class="c1"># store the intent based on the refined combo</span>
            <span class="n">next_out</span><span class="p">[</span><span class="s2">&quot;intent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">refined_combo</span>
            <span class="n">outcome_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">entity</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">certainty</span><span class="si">}</span><span class="s2">-&quot;</span>
                <span class="k">for</span> <span class="n">entity</span><span class="p">,</span> <span class="n">certainty</span> <span class="ow">in</span> <span class="n">refined_combo</span><span class="o">.</span><span class="n">items</span><span class="p">())[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1"># add the updates based on what&#39;s in this refined combo (again,</span>
            <span class="c1"># ignoring what we didn&#39;t find)</span>
            <span class="k">for</span> <span class="n">entity</span><span class="p">,</span> <span class="n">certainty</span> <span class="ow">in</span> <span class="n">refined_combo</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">next_out</span><span class="p">[</span><span class="s2">&quot;updates&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">map_assignment_update</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">certainty</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">additional_updates</span><span class="p">:</span>
                <span class="c1"># convert the current outcome into a frozenset to be compared</span>
                <span class="n">key</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="n">entity</span><span class="p">:</span> <span class="n">certainty</span>
                        <span class="k">for</span> <span class="n">entity</span><span class="p">,</span> <span class="n">certainty</span> <span class="ow">in</span> <span class="n">refined_combo</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="c1"># check if this frozenset is included in the dict of outcomes with</span>
                <span class="c1"># additional updates; if so, add the appropriate updates</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">cfg_updates</span><span class="p">:</span>
                    <span class="n">new_upd_cfg</span> <span class="o">=</span> <span class="n">cfg_updates</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;updates&quot;</span> <span class="ow">in</span> <span class="n">new_upd_cfg</span><span class="p">:</span>
                        <span class="n">next_out</span><span class="p">[</span><span class="s2">&quot;updates&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_upd_cfg</span><span class="p">[</span><span class="s2">&quot;updates&quot;</span><span class="p">])</span>
                    <span class="k">if</span> <span class="s2">&quot;response_variants&quot;</span> <span class="ow">in</span> <span class="n">new_upd_cfg</span><span class="p">:</span>
                        <span class="n">next_out</span><span class="p">[</span><span class="s2">&quot;response_variants&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_upd_cfg</span><span class="p">[</span>
                            <span class="s2">&quot;response_variants&quot;</span>
                        <span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;follow_up&quot;</span> <span class="ow">in</span> <span class="n">new_upd_cfg</span><span class="p">:</span>
                        <span class="n">next_out</span><span class="p">[</span><span class="s2">&quot;follow_up&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_upd_cfg</span><span class="p">[</span><span class="s2">&quot;follow_up&quot;</span><span class="p">]</span>
            <span class="n">action</span><span class="p">[</span><span class="s2">&quot;effect&quot;</span><span class="p">][</span><span class="s2">&quot;validate-slot-fill&quot;</span><span class="p">][</span><span class="s2">&quot;oneof&quot;</span><span class="p">][</span><span class="s2">&quot;outcomes&quot;</span><span class="p">][</span>
                <span class="n">outcome_name</span>
            <span class="p">]</span> <span class="o">=</span> <span class="n">next_out</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;slot-fill__</span><span class="si">{</span><span class="n">action_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">action</span><span class="p">}</span>
    <span class="c1"># create clarifications and single slot actions as necessary</span>
    <span class="n">new_actions</span><span class="p">,</span> <span class="n">new_ctx_vars</span> <span class="o">=</span> <span class="n">_create_clarifications_single_slots</span><span class="p">(</span>
        <span class="n">action_name</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">entities</span><span class="p">,</span> <span class="n">config_entities</span><span class="p">,</span> <span class="n">loaded_yaml</span><span class="p">[</span><span class="s2">&quot;context_variables&quot;</span><span class="p">],</span> <span class="n">additional_updates</span>
    <span class="p">)</span>
    <span class="c1"># update the loaded YAML with the new actions</span>
    <span class="n">actions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_actions</span><span class="p">)</span>
    <span class="n">loaded_yaml</span><span class="p">[</span><span class="s2">&quot;actions&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
    <span class="n">loaded_yaml</span><span class="p">[</span><span class="s2">&quot;context_variables&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_ctx_vars</span><span class="p">)</span></div>

<div class="viewcode-block" id="_clarify_act"><a class="viewcode-back" href="../../../../generated/plan4dial.for_generating.custom_actions.slot_fill.html#plan4dial.for_generating.custom_actions.slot_fill._clarify_act">[docs]</a><span class="k">def</span> <span class="nf">_clarify_act</span><span class="p">(</span><span class="n">entity</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">message_variants</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">single_slot</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">additional_updates</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Generates a `clarify` action for an entity.</span>

<span class="sd">    Args:</span>
<span class="sd">    - entity (str): The entity to generate the action for.</span>
<span class="sd">    - message_variants (List[str]): The message variants for the clarification</span>
<span class="sd">    action.</span>
<span class="sd">    - single_slot (bool): Determines if this entity also has a `single_slot`</span>
<span class="sd">    action. This is necessary because of the situation where we &quot;maybe&quot; found</span>
<span class="sd">    the entity in the original action, try to clarify it and fail, and we were</span>
<span class="sd">    trying to extract &gt; 1 entities originally. In that case, we need to</span>
<span class="sd">    activate the appropriate `single_slot` </span>
<span class="sd">    - additional_updates (Dict, optional): Any additional updates. In reality,</span>
<span class="sd">    it will only consider those where just this entity is extracted. Defaults</span>
<span class="sd">    to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - (Dict): The `clarify` action configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">confirm_updates</span> <span class="o">=</span> <span class="n">map_assignment_update</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="s2">&quot;found&quot;</span><span class="p">)</span>
    <span class="c1"># consider additional updates if the entity is extracted</span>
    <span class="k">if</span> <span class="n">additional_updates</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span><span class="n">entity</span><span class="p">:</span> <span class="s2">&quot;found&quot;</span><span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">additional_updates</span><span class="p">:</span>
            <span class="n">confirm_updates</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">additional_updates</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
    <span class="n">deny_updates</span> <span class="o">=</span> <span class="n">map_assignment_update</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="s2">&quot;didnt-find&quot;</span><span class="p">)</span>
    <span class="c1"># if we were originally trying to extract multiple entities and we weren&#39;t</span>
    <span class="c1"># able to clarify one of them, we will have to move on to extracting the</span>
    <span class="c1"># entity with a single_slot action. the single_slot action has to be</span>
    <span class="c1"># disabled by default so that it doesn&#39;t run before the initial action</span>
    <span class="c1"># (that tries to extract all entities).</span>
    <span class="k">if</span> <span class="n">single_slot</span><span class="p">:</span>
        <span class="n">deny_updates</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;allow_single_slot_</span><span class="si">{</span><span class="n">entity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
    <span class="n">clarify</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">clarify</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="n">clarify</span><span class="p">[</span><span class="s2">&quot;subtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;dialogue&quot;</span><span class="p">,</span> <span class="s2">&quot;dialogue disambiguation&quot;</span>
    <span class="n">clarify</span><span class="p">[</span><span class="s2">&quot;message_variants&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">message_variants</span>
    <span class="n">clarify</span><span class="p">[</span><span class="s2">&quot;condition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">entity</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;known&quot;</span><span class="p">:</span> <span class="s2">&quot;maybe&quot;</span><span class="p">}}</span>
    <span class="n">clarify</span><span class="p">[</span><span class="s2">&quot;effect&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;validate-clarification&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;oneof&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;outcomes&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;confirm&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;updates&quot;</span><span class="p">:</span> <span class="n">confirm_updates</span><span class="p">,</span>
                        <span class="s2">&quot;intent&quot;</span><span class="p">:</span> <span class="s2">&quot;confirm&quot;</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;deny&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;updates&quot;</span><span class="p">:</span> <span class="n">deny_updates</span><span class="p">,</span>
                        <span class="s2">&quot;intent&quot;</span><span class="p">:</span> <span class="s2">&quot;deny&quot;</span><span class="p">,</span>
                    <span class="p">},</span>
                <span class="p">},</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;clarify__</span><span class="si">{</span><span class="n">entity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">clarify</span><span class="p">}</span></div>


<div class="viewcode-block" id="_single_slot"><a class="viewcode-back" href="../../../../generated/plan4dial.for_generating.custom_actions.slot_fill.html#plan4dial.for_generating.custom_actions.slot_fill._single_slot">[docs]</a><span class="k">def</span> <span class="nf">_single_slot</span><span class="p">(</span><span class="n">entity</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config_entity</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">known_is_fflag</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">additional_updates</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Generates a &#39;single slot&#39; action for the entity provided. These are only</span>
<span class="sd">    necessary when multiple entities were specified, to handle the case where</span>
<span class="sd">    the bot is able to only extract some on its first go and `clarify` actions</span>
<span class="sd">    as well as actions that extract an entity on its own (`single_slot`) need</span>
<span class="sd">    to take care of the rest.</span>

<span class="sd">    Args:</span>
<span class="sd">    - entity (str): The entity to generate the action for.</span>
<span class="sd">    - config_entity (Dict): The `config_entities` configuration for this</span>
<span class="sd">    entity. Necessary so that we can access the `single_slot_message_variants`</span>
<span class="sd">    and `fallback_message_variants` if they exist.</span>
<span class="sd">    - known_is_fflag (bool): Indicates if the `known` setting for the entity in</span>
<span class="sd">    question is of type `fflag`.</span>
<span class="sd">    - additional_updates (Dict, optional): Any additional updates. In reality,</span>
<span class="sd">    it will only consider those where just this entity is extracted, or maybe</span>
<span class="sd">    extracted. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - (Dict): The `single_slot` action configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fill_slot_updates</span> <span class="o">=</span> <span class="n">map_assignment_update</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="s2">&quot;found&quot;</span><span class="p">)</span>
    
    <span class="c1"># if we successfully extract the entity, we should reset this flag.</span>
    <span class="c1"># while it might not seem important, if all the entities are reset to null</span>
    <span class="c1"># at some point, then we need to ensure that the original action runs first</span>
    <span class="c1"># to re-extract all the entities, and not any of the `single_slot` actions.</span>
    <span class="n">fill_slot_updates</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;allow_single_slot_</span><span class="si">{</span><span class="n">entity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
    <span class="c1"># add additional updates if they exist</span>
    <span class="k">if</span> <span class="n">additional_updates</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span><span class="n">entity</span><span class="p">:</span> <span class="s2">&quot;found&quot;</span><span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">additional_updates</span><span class="p">:</span>
            <span class="n">fill_slot_updates</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">additional_updates</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
    <span class="c1"># add message variants if they exist</span>
    <span class="n">message_variants</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">config_entity</span><span class="p">[</span><span class="s2">&quot;single_slot_message_variants&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;single_slot_message_variants&quot;</span> <span class="ow">in</span> <span class="n">config_entity</span>
        <span class="k">else</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Please enter a valid value for </span><span class="si">{</span><span class="n">entity</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">single_slot</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">single_slot</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="n">single_slot</span><span class="p">[</span><span class="s2">&quot;subtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;dialogue&quot;</span><span class="p">,</span> <span class="s2">&quot;dialogue disambiguation&quot;</span>
    <span class="n">single_slot</span><span class="p">[</span><span class="s2">&quot;message_variants&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">message_variants</span>
    <span class="c1"># condition: we can&#39;t know the entity and we have to have tried to extract</span>
    <span class="c1"># it with the original `slot_fill` action along with the other entities</span>
    <span class="c1"># already</span>
    <span class="n">single_slot</span><span class="p">[</span><span class="s2">&quot;condition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">entity</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;known&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
        <span class="sa">f</span><span class="s2">&quot;allow_single_slot_</span><span class="si">{</span><span class="n">entity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="p">}</span>
    <span class="n">single_slot</span><span class="p">[</span><span class="s2">&quot;effect&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;validate-slot-fill&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;oneof&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;outcomes&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;fill-slot&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;updates&quot;</span><span class="p">:</span> <span class="n">fill_slot_updates</span><span class="p">,</span>
                        <span class="s2">&quot;intent&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">entity</span><span class="p">:</span> <span class="s2">&quot;found&quot;</span><span class="p">},</span>
                    <span class="p">}</span>
                <span class="p">},</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">known_is_fflag</span><span class="p">:</span>
        <span class="c1"># add additional updates if they exist</span>
        <span class="k">if</span> <span class="n">additional_updates</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span><span class="n">entity</span><span class="p">:</span> <span class="s2">&quot;maybe-found&quot;</span><span class="p">}</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">additional_updates</span><span class="p">:</span>
                <span class="n">slot_unclear_updates</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">additional_updates</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="n">slot_unclear_updates</span> <span class="o">=</span> <span class="n">map_assignment_update</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="s2">&quot;maybe-found&quot;</span><span class="p">)</span>
        <span class="n">single_slot</span><span class="p">[</span><span class="s2">&quot;effect&quot;</span><span class="p">][</span><span class="s2">&quot;validate-slot-fill&quot;</span><span class="p">][</span><span class="s2">&quot;oneof&quot;</span><span class="p">][</span><span class="s2">&quot;outcomes&quot;</span><span class="p">][</span><span class="s2">&quot;slot-unclear&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s2">&quot;updates&quot;</span><span class="p">:</span> <span class="n">slot_unclear_updates</span><span class="p">,</span>
                        <span class="s2">&quot;intent&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">entity</span><span class="p">:</span> <span class="s2">&quot;maybe-found&quot;</span><span class="p">},</span>
                    <span class="p">}</span>
    <span class="k">if</span> <span class="s2">&quot;fallback_message_variants&quot;</span> <span class="ow">in</span> <span class="n">config_entity</span><span class="p">:</span>
        <span class="n">single_slot</span><span class="p">[</span><span class="s2">&quot;fallback_message_variants&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">config_entity</span><span class="p">[</span>
            <span class="s2">&quot;fallback_message_variants&quot;</span>
        <span class="p">]</span>
    <span class="k">return</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;single_slot__</span><span class="si">{</span><span class="n">entity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">single_slot</span><span class="p">}</span></div>


<div class="viewcode-block" id="_create_clarifications_single_slots"><a class="viewcode-back" href="../../../../generated/plan4dial.for_generating.custom_actions.slot_fill.html#plan4dial.for_generating.custom_actions.slot_fill._create_clarifications_single_slots">[docs]</a><span class="k">def</span> <span class="nf">_create_clarifications_single_slots</span><span class="p">(</span>
    <span class="n">original_act_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">original_act_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="n">entities</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">config_entities</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="n">context_variables</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="n">additional_updates</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Used by the `slot_fill` action to generate `clarify` and `single_slot`</span>
<span class="sd">    actions where necessary.</span>

<span class="sd">    Args:</span>
<span class="sd">    - original_act_name (str): The action name given to the original</span>
<span class="sd">    `slot_fill` action</span>
<span class="sd">    - original_act_config (Dict): The configuration of the original `slot_fill`</span>
<span class="sd">    action.</span>
<span class="sd">    - entities (List[str]): The total list of entities to extract.</span>
<span class="sd">    - config_entities (Dict): Configurations for these entities that hold more</span>
<span class="sd">    information.</span>
<span class="sd">    - context_variables (Dict): The context variable configuration from</span>
<span class="sd">    `loaded_yaml`.</span>
<span class="sd">    - additional_updates (Dict, optional): Any additional updates. Defaults to</span>
<span class="sd">    None.</span>

<span class="sd">    Returns:</span>
<span class="sd">    (Tuple[Dict, Dict]): The new actions and context variables to be added.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_actions</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">new_ctx_vars</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entities</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># only resort to single slot actions if we were not able to extract all entities in one go</span>
        <span class="k">for</span> <span class="n">eff</span><span class="p">,</span> <span class="n">eff_config</span> <span class="ow">in</span> <span class="n">original_act_config</span><span class="p">[</span><span class="s2">&quot;effect&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">eff_config</span><span class="p">:</span>
                <span class="n">outcomes</span> <span class="o">=</span> <span class="n">eff_config</span><span class="p">[</span><span class="n">option</span><span class="p">][</span><span class="s2">&quot;outcomes&quot;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">out</span><span class="p">,</span> <span class="n">out_config</span> <span class="ow">in</span> <span class="n">outcomes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="s2">&quot;updates&quot;</span> <span class="ow">in</span> <span class="n">out_config</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">entities</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">entity</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out_config</span><span class="p">[</span><span class="s2">&quot;updates&quot;</span><span class="p">]:</span>
                                <span class="n">new_ctx_vars</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;allow_single_slot_</span><span class="si">{</span><span class="n">entity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;flag&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;init&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                                <span class="p">}</span>
                                <span class="n">original_act_config</span><span class="p">[</span><span class="s2">&quot;effect&quot;</span><span class="p">][</span><span class="n">eff</span><span class="p">][</span><span class="n">option</span><span class="p">][</span><span class="s2">&quot;outcomes&quot;</span><span class="p">][</span><span class="n">out</span><span class="p">][</span>
                                    <span class="s2">&quot;updates&quot;</span>
                                <span class="p">][</span><span class="sa">f</span><span class="s2">&quot;allow_single_slot_</span><span class="si">{</span><span class="n">entity</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
                                <span class="n">new_actions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                                    <span class="n">_single_slot</span><span class="p">(</span>
                                        <span class="n">entity</span><span class="p">,</span> <span class="n">config_entities</span><span class="p">[</span><span class="n">entity</span><span class="p">],</span> <span class="n">context_variables</span><span class="p">[</span><span class="n">entity</span><span class="p">][</span><span class="s2">&quot;known&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;fflag&quot;</span><span class="p">,</span> <span class="n">additional_updates</span>
                                    <span class="p">)</span>
                                <span class="p">)</span>
        <span class="n">new_actions</span><span class="p">[</span><span class="n">original_act_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">original_act_config</span>
    <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">entities</span><span class="p">:</span>
        <span class="c1"># only create clarify actions if clarify messages were specified</span>
        <span class="k">if</span> <span class="n">context_variables</span><span class="p">[</span><span class="n">entity</span><span class="p">][</span><span class="s2">&quot;known&quot;</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;fflag&quot;</span> <span class="ow">and</span> <span class="s2">&quot;clarify_message_variants&quot;</span> <span class="ow">in</span> <span class="n">config_entities</span><span class="p">[</span><span class="n">entity</span><span class="p">]:</span>
            <span class="n">new_actions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="n">_clarify_act</span><span class="p">(</span>
                    <span class="n">entity</span><span class="p">,</span>
                    <span class="n">config_entities</span><span class="p">[</span><span class="n">entity</span><span class="p">][</span><span class="s2">&quot;clarify_message_variants&quot;</span><span class="p">],</span>
                    <span class="sa">f</span><span class="s2">&quot;allow_single_slot_</span><span class="si">{</span><span class="n">entity</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">new_ctx_vars</span><span class="p">,</span>
                    <span class="n">additional_updates</span>
                <span class="p">)</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">new_actions</span><span class="p">,</span> <span class="n">new_ctx_vars</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">Plan4Dial</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../generated/plan4dial.html">plan4dial</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Rebecca De Venezia @ QuMuLab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.2.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>