---
name: bank-bot
context_variables:
  task:
    outing_type:
    type: enum
    known:
      type: flag
      init: false 
    options:
      transfer funds between accounts:
        variations:
          - transfer funds
          - move money over
          - transfer between accounts
          - transfer money over to another account
      # e-transfer:
      #   variations:
      #     - transfer to another person
      #     - transfer money to another person
      #     - send money to someone
      #     - give money to someone else
      #     - send money to another person
      #     - give money to another person
      #     - transfer money to Mark
      #     - transfer funds to Beth
      #     - send money to Sam
      #     - give money to Tiana
      # request money:
      #   variations:
      #     - request money from someone
      #     - request money from this person
      #     - request funds from Bob
      # pay bills:
      #   variations:
      #     - pay my bills
      #     - pay my credit card bill
      #     - pay off my student loans
      #     - pay my monthly utility bill
      # cancel card:
      #   variations:
      #     - cancel my credit card
      #     - cancel my debit card
      #     - remove card from my account
  account1:
    outing_type:
    type: enum
    known:
      type: flag
      init: false 
    options:
      - chequing
      - savings
      - retirement fund
      - college fund
  account2:
    outing_type:
    type: enum
    known:
      type: flag
      init: false 
    options:
      - chequing
      - savings
      - retirement fund
      - college fund
  funds:
    type: json
    extraction: 
      method: regex
      pattern: ^[1-9]\d*$
    known:
      type: flag
      init: false
  goal:
    type: flag
    init: false
    known:
      type: flag
      init: false
intents:
  confirm:
    utterances:
      - "yes"
      - yeah
      - that's it
      - "Y"
      - mhm
      - confirm
      - yes please
  deny:
    utterances:
      - "no"
      - not at all
      - that's not what i meant
      - absolutely not
      - i don't want that
      - nah
      - no thanks
      - no thank you
  share_task:
    entities:
      - task
    utterances:
      - I want to $task.
      - I just want to $task today.
      - Can you help me $task?
  share_transfer_settings:
    entities:
      - account1
      - account2
      - funds
    utterances:
      - I want to transfer $funds from $account1 to $account2.
      - Can I transfer $funds from $account1 to $account2?
      - I want to send $funds to $account2 from $account1.
      - I want to send $funds to $account2 from $account1.
actions:
  get-task:
    type: custom
    subtype: slot_fill
    parameters:
      action_name: get-task
      overall_intent: share_task
      entities:
        - task
      message_variants:
        - What would you like to do next? Your options are`:`\ntransfer funds between accounts\ne-transfer\nrequest money\npay bills\ncancel card
      fallback_message_variants:
        - Sorry, that isn't a valid banking option.
  get-transfer-settings:
    type: dialogue
    message_variants:
      - Which accounts do you want to transfer funds between, and how much?
      - Which accounts do you want to send money to and from, and how much?
      - Please enter the accounts you want to transfer money between and the amount of money you wish to send.
    fallback_message_variants:
      - Sorry, that isn't a valid transfer option.    
    condition:
      account1:
        known: false
      account2:
        known: false
      funds:
        known: false
      task:
        known: true
        value: transfer funds between accounts
    effect:
      validate:
        oneof:
          outcomes:
            complete-transfer:
              updates:
                account1:
                  known: true
                  value: $account1
                account2:
                  known: true
                  value: $account2
                funds:
                  known: true
                  value: $funds
              intent: share_transfer_settings
  confirm-transfer:
    type: dialogue
    disable-fallback: true
    message_variants:
      - Transferring $funds from $account1 to $account2...
    condition:
      account1:
        known: true
      account2:
        known: true
      funds:
        known: true
    effect:
      set-allergy:
        oneof:
          outcomes:
            complete-transfer:
              updates:
                account1:
                  known: false
                account2:
                  known: false
                funds:
                  known: false
                goal:
                  value: true
              intent:
...